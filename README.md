# Windows Incident Response Collector (IR_Collector.ps1)


## 소개
IR_Collector.ps1 는 Windows 환경에서 침해사고(Incident Response) 초기 대응을 위해 설계된 PowerShell 기반 자동 수집 스크립트입니다.
보안 담당자, 포렌식 분석가, 그리고 사고 대응팀이 현장에서 빠르게 시스템 상태를 확보하고 증거를 보존할 수 있도록 다양한 정보를 체계적으로 수집합니다.


## 주요 기능

이 스크립트는 다음과 같은 정보를 자동으로 수집/정리합니다.
1. 시스템 정보
2. 현재 시각, 시스템 부팅 시각
3. Windows 버전 및 빌드 정보
4. 하드웨어/운영체제 기본 정보
5. 실행 중인 구성요소
6. 드라이브 및 볼륨 정보
7. 서비스 상태
8. 실행 중인 프로세스 목록
9. 예약 작업(Scheduled Task)
10. 네트워크 현황
11. 네트워크 인터페이스 및 TCP 연결
12. ARP 테이블
13. 라우팅 테이블
14. DNS 캐시
15. 계정 및 세션 정보
16. 현재 로그인 세션 (quser/qwinsta + CIM fallback)
17. 로컬 사용자 및 관리자 그룹
18. 공유 리소스 목록
19. 레지스트리 기반 아티팩트
20. 자동 실행(Autorun) 프로그램
21. 설치된 소프트웨어(레지스트리 export)
22. 무결성 보장
23. 수집된 모든 파일에 대해 SHA256 해시 생성
24. 결과물을 ZIP 아카이브로 자동 패키징


## 특징

- PowerShell 5.1 호환성: Windows 7 이상에서 바로 실행 가능
- 강력한 Fallback 처리: quser.exe, qwinsta.exe 등이 없을 경우에도 CIM/WMI로 대체 수집
- 안전한 출력 처리: JSON, CSV, TXT 등 상황별 적절한 포맷 자동 선택
- 무결성 검증: 수집된 아티팩트의 해시값 생성 → 법적 증거 보존에 유리
- ZIP 아카이브 생성: 단일 패키지로 정리되어 전달·보관 용이


## 사용 방법

powershell -ExecutionPolicy Bypass -File .\IR_Collector.ps1


## 주의 사항

- 관리자 권한으로 실행하는 것을 권장합니다.
- 수집된 결과물에는 민감한 정보(계정, 네트워크, 설치 프로그램 목록 등)가 포함될 수 있으므로 보관 및 전달 시 주의가 필요합니다.
- 본 스크립트는 초기 대응 수집 도구이며, 분석은 별도의 포렌식 절차가 필요합니다.